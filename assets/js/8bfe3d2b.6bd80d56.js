"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[263],{7213:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>u,frontMatter:()=>c,metadata:()=>o,toc:()=>d});var t=s(4848),i=s(8453),l=s(6025);const c={id:"examples",title:"DevOopsGitHubReleasePlugin Examples",sidebar_label:"Examples"},a=void 0,o={id:"gh-release-plugin/examples",title:"DevOopsGitHubReleasePlugin Examples",description:"With GitHub Actions",source:"@site/docs/gh-release-plugin/examples.md",sourceDirName:"gh-release-plugin",slug:"/gh-release-plugin/examples",permalink:"/docs/gh-release-plugin/examples",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"examples",title:"DevOopsGitHubReleasePlugin Examples",sidebar_label:"Examples"},sidebar:"docsSidebar",previous:{title:"Config and Run",permalink:"/docs/gh-release-plugin/config-and-run"},next:{title:"How to Use",permalink:"/docs/scala-plugin/how-to-use"}},r={},d=[{value:"With GitHub Actions",id:"with-github-actions",level:2},{value:"A Single Project",id:"a-single-project",level:2},{value:"<code>build.sbt</code>",id:"buildsbt",level:3},{value:"GitHub Actions Config",id:"github-actions-config",level:3},{value:"A Project with Multiple Sub-projects",id:"a-project-with-multiple-sub-projects",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",input:"input",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"with-github-actions",children:"With GitHub Actions"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"PROJECT_ROOT/project/plugins.sbt"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-scala",children:'addSbtPlugin("io.kevinlee" % "sbt-devoops" % "3.2.0")\n'})}),"\n",(0,t.jsx)(n.h2,{id:"a-single-project",children:"A Single Project"}),"\n",(0,t.jsx)(n.p,{children:"A single project in the root."}),"\n",(0,t.jsx)(n.h3,{id:"buildsbt",children:(0,t.jsx)(n.code,{children:"build.sbt"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"PROJECT_ROOT/build.sbt"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-scala",children:'ThisBuild / organization := "com.example"\nThisBuild / scalaVersion := "2.13.3"\nThisBuild / version := "0.1.0"\n\nlazy val root = (project in file("."))\n  .enablePlugins(DevOopsGitHubReleasePlugin)\n  .settings(\n    name := "test-project",\n    libraryDependencies += "some" %% "lib" % "1.0.0"\n  )\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Make sure you have changelog in the ",(0,t.jsx)(n.code,{children:"PROJECT_ROOT/changelogs"})," folder."]}),"\n",(0,t.jsxs)(n.p,{children:["e.g.)\nIf the project version in ",(0,t.jsx)(n.code,{children:"build.sbt"})," is ",(0,t.jsx)(n.code,{children:"0.1.0"}),","]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"PROJECT_ROOT/changelogs/0.1.0.md"})}),"\n",(0,t.jsx)(n.h3,{id:"github-actions-config",children:"GitHub Actions Config"}),"\n",(0,t.jsxs)(n.p,{children:["Before setting up GitHub Actions, make sure you have a GitHub\n",(0,t.jsx)(n.a,{href:"https://github.com/settings/tokens",children:"personal access token"}),"\nwith at least the ",(0,t.jsx)(n.code,{children:"publis_repo"})," scope."]}),"\n",(0,t.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(n.li,{className:"task-list-item",children:[(0,t.jsx)(n.input,{type:"checkbox",checked:!0,disabled:!0})," ",(0,t.jsx)(n.code,{children:"public_repo     Access public repositories"}),"\n",(0,t.jsx)("img",{alt:"Person Access Token Scope",src:(0,l.A)("img/github-personal-access-token.png")}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["and add the access token to the project's ",(0,t.jsx)(n.code,{children:"Secrets"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"e.g.)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Go to ",(0,t.jsx)(n.a,{href:"https://github.com/YOUR_USERNAME/YOUR_PROJECT/settings/secrets",children:"https://github.com/YOUR_USERNAME/YOUR_PROJECT/settings/secrets"})]}),"\n",(0,t.jsxs)(n.li,{children:["Click the ",(0,t.jsx)(n.code,{children:"New secret"})," button"]}),"\n",(0,t.jsxs)(n.li,{children:["In the ",(0,t.jsx)(n.code,{children:"Name"}),", put the access token name you want (e.g. ",(0,t.jsx)(n.code,{children:"RELEASE_GITHUB_TOKEN"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Add the token to the ",(0,t.jsx)(n.code,{children:"Value"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["To release whenever tag is created and pushed to the remote repo,\nadd the GitHub Actions config yaml file like the following one to\n",(0,t.jsx)(n.code,{children:"PROJECT_ROOT/.github/workflows"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["e.g. ",(0,t.jsx)(n.code,{children:"release.yml"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"name: Release\n\non:\n  push:\n    tags:\n      - '*'\n\njobs:\n  build:\n\n    runs-on: ubuntu-latest\n\n    strategy:\n      matrix:\n        scala:\n          - { version: \"2.13.3\", binary-version: \"2.13\", java-version: \"11\" }\n\n    steps:\n    - uses: actions/checkout@v2\n    - uses: actions/setup-java@v1\n      with:\n        java-version: ${{ matrix.scala.java-version }}\n\n    - name: Cache SBT\n      uses: actions/cache@v2\n      with:\n        path: |\n          ~/.ivy2/cache\n          ~/.cache/coursier\n          ~/.sbt\n        key: ${{ runner.os }}-sbt-${{ matrix.scala.binary-version }}-${{ hashFiles('**/*.sbt') }}-${{ hashFiles('**/build.properties') }}\n        restore-keys: |\n          ${{ runner.os }}-sbt-${{ matrix.scala.binary-version }}-\n\n    - name: sbt GitHub Release\n      env:\n        GITHUB_TOKEN: ${{ secrets.RELEASE_GITHUB_TOKEN }}\n      run: |\n        echo \"Run] sbt GitHub release\"\n        echo 'sbt -J-Xmx2048m ++${{ matrix.scala.version }}! clean test packagedArtifacts'\n        sbt -J-Xmx2048m \\\n          ++${{ matrix.scala.version }}! \\\n          clean \\\n          test \\\n          packagedArtifacts \\\n          devOopsGitHubRelease \\\n          devOopsGitHubReleaseUploadArtifacts\n\n"})}),"\n",(0,t.jsx)(n.p,{children:"If you want to manually run it, you need run at least the following three tasks."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sbt packagedArtifacts devOopsGitHubRelease devOopsGitHubReleaseUploadArtifacts\n"})}),"\n",(0,t.jsx)(n.h2,{id:"a-project-with-multiple-sub-projects",children:"A Project with Multiple Sub-projects"}),"\n",(0,t.jsx)(n.admonition,{title:"NOTE:",type:"caution",children:(0,t.jsx)(n.p,{children:"To be added..."})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>a});var t=s(6540);const i={},l=t.createContext(i);function c(e){const n=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);